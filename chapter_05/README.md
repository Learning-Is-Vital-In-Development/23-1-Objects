# Chapter 05 - 책임 할당하기

### 데이터 중심 설계 → 책임 중심 설계

- 데이터보다는 행동을 먼저 결정

→ “이 객체가 수행해야 하는 책임은 무엇인가”를 결정한 후, “이 책임을 수행하는 데 필요한 데이터는 무엇인가”를 결정하라

- 협력이라는 문맥 안에서 책임을 결정

→ 메시지를 전송하는 클라이언트의 의도에 적합한 책이을 할당해야 한다

→ 객체가 메시지를 선택 X, 메시지가 객체를 선택하게 하라

클라이언트는 어떤 객체가 메시지를 수신할 지 알지 못함 → 메시지 먼저 결정하므로 메시지 송신자는 수신자에 대한 어떠한 가정도 할 수 없음 → 메시지 수신자의 캡슐화 성공

### GRASP 패턴

“General Responsibility Assignment Sofrware Pattern”: 객체에게 책임 할당할 때 지침으로 삼는 원칙들을 패턴 형식으로 정리한 것

- 도메인 개념에서 시작하기

→ 도메인 개념을 정리하는데 많은 시간 소비 X, 빠르게 설계와 구현을 진행하는 것이 바람직함

- 정보 전문가에게 책임 할당

→ 책임을 수행할 정보를 (가장 많이) 알고 있는 객체에게 책임을 할당: **INFORMATION EXPERT(정보 전문가) 패턴**

정보 전문가가 데이터를 반드시 저장하고 있을 필요는 없음 → 해당 정보를 제공할 수 있는 다른 객체를 알고 있거나 필요한 정보 계산 가능

- 높은 응집도, 낮은 결합도

**LOW COUPLING(낮은 결합도), HIGH COHESION(높은 응집도)** 패턴 : 의존성 낮추고 변화의 영향을 줄이고 재사용성을 증가시킬 수 있는 설계를 선택

- **CREATOR 패턴** : 객체를 생성할 책임을 어떤 객체에게 할당할지에 대한 지침을 제공
- 객체 A를 생성할 때, 객체 생성 책임을 할당할 B는
    - A 객체를 포함하거나 참조함
    - A 객체를 기록함
    - A 객체를 긴밀하게 사용함
    - A 객체를 초기화하는 데 필요한 데이터를 가짐
- 위 조건을 최대한 많이 만족하는 B를 선택해야 함

### 클래스 응집도 판단하기

- 클래스가 하나 이상의 이유로 변경되어야 할 때
- 클래스의 인스터스를 초기화하는 시점에 경우에 따라 서로 다른 속성들을 초기화하고 있을 때
- 메서드 그룹이 속성 그룹을 사용하는지 여부로 나뉠 때

→ 위 세 가지 문제를 가졌을 때 대부분 응집도가 낮다고 볼 수 있다

응집도가 낮다 → 서로 연관성이 없는 기능이나 데이터가 하나의 클래스 안에 뭉쳐져 있다

→ **변경의 이유에 따라 클래스를 분리해야 함(ex: 타입 분리하기, 다형성을 통해 분리하기)**

- **인스턴스 변수가 초기화되는 시점**을 기준으로 변경의 이유 파악하기
    - 응집도가 높은 클래스 → 인스턴스를 생성할 때 모든 속성을 함께 초기화함
    - 응집도가 낮은 클래스 → 객체의 속성 중 일부만 초기화하고 일부는 초기화되지 않은 상태로 남겨짐
- **POLYMORPHISM(다형성)** 패턴 : 객체의 타입에 따라 변하는 행동이 있다면 타입을 분리하고 변화하는 행동을 각 타입의 책임으로 할당하는 것
- **PROTECTED VARIATIONS(변경 보호)** 패턴 : 변화가 예상되는 불안정한 지점들을 식별하고 그 주위에 안정된 인터페이스를 형성하도록 책임을 할당하는 것
